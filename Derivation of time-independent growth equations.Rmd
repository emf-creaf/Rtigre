---
title: "Derivation of time-independent growth functions"
author: "R. Molowny-Horas"
date: "`r Sys.Date()`"
header-includes:
  - \usepackage{enumerate}
output:
  pdf_document: default
  html_document: default
  word_document: default
vignette: >
  %\VignetteIndexEntry{Derivation of time-independent growth functions}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---

<br>
<br>

### Introduction

Growth, understood as the increase of the physical dimensions of an organism, characterizes the temporal evolution of a living entity more than almost any other feature. By physical dimensions we mean quantities such as size, height, weight, volume, etc. that are directly related to the spatial space occupied by that organism. For example, we may speak about diameter or height for trees, weight for mamals or volume for ***. As time passes, then, one expects growth*** At the same time, one expects growth to slow down at older age ***. Finally, maximum size is an upper limit to the physical dimensions of any individual that is dictated by structural and physiologically constraints. That limit is usually unknown but can be guessed by checking the observed trends in growth.

Although the positive increment of those physical dimensions may slow down, stop or even reverse in some organisms depending on, for example, worsening environmental conditions or fiercer competition (EXAMPLES?), hereby we will concern ourselves only with those cases where a physical dimension increases as time passes. In addition, we assume that, in most cases, organisms do not grow indefinitely, irrespective of the amount of resources at their disposal. Rather, there is always a limit to that growth that is set by structural constraints.

Finding a growth function from which a simple time-independent expression can be derived is not an easy task. One is seeking for a functional expression where size at a time $t_{2}$ depends on previous size at time $t_{1}$, with $t_{1}<t_{2}$, plus some set of free parameters. Those parameters, if not known beforehand, are usually calculated via a regression scheme.

Below we will derive time-independent (also known as age-independent) curves for several growth functions. These curves all share the characteristic of having a sigmoid shape, which implies that there is always asymptotic minimum and maximum sizes. This fits well with the general idea that, 

Some of the curves are solutions of ordinary differential equations which have been used ***. Others, whoever, simply have a sigmoid shape which makes them appropriate for our objectives.

Some of the growth curves that are explained below are well-known and widely used (e.g. logistic, Schumacher, Gompertz, monomolecular) whereas others are more rarely employed (e.g. arctangent, hyperbolic tangent). The dependence of growth on explanatory variables like e.g. climatic, landscape, competition, etc. is conveyed through the growth rate parameter $k$, which is defined as a coefficient that explicitly multiplies time (or age) $t$. In addition, we allow for a term $B$ which accounts for any offset in the growth curve. As we will see below, this summative offset nevertheless vanishes in all cases when size is expressed as a function of previous size (i.e. time or age-independence). Finally, diameter growth $y_{2}-y_{1}=0$ when $t=0$ or $k=0$ in all cases, as expected.

The obvious non-linearity of the time-independent equations below makes it challenging to devise a regression scheme with which to fit those expressions to a set of observational data. Good starting guesses for the parameters of the fit become a key ingredient for a quick and satisfactory convergence of the regression algorithms. Otherwise, those algorithms may fail to converge, or do so to a local, rather than global, extreme. Therefore, we have extracted simple expressions for the so-called growth rate parameter $k$, which can be fitted in an initial step as linear expressions of the predictors. The coefficients thus calculated can then be used as first guesses for the full non-linear regression to the time-independent growth curves.

<br>

#### Logistic growth function

The logistic curve is one of the most widely used functions to determine the growth of an individual plant or animal. In a general case, in which size depends on time $t$ as well as on a set of predictors (e.g. climatic, topographic), the size $y$ of an organism that obeys the logistic rule can be written:

\begin{equation}
  y=\frac{A}{1+e^{-\left(k\cdot t+B\right)}}
\end{equation}

where $A$ indicates the asymptotic value of $y$ when $t\to \infty$, $B$ is an offset parameter and $k$ is the growth rate parameter. To obtain a time-independent growth equation that determines growth between two time points $t_{1}$ and $t_{2}$, $t_{1}<t_{2}$, we start by rewriting $t$ as:

\begin{equation}
  e^{-\left(k\cdot t+B\right)}=\frac{A}{y}-1
\end{equation}

\begin{equation}
  t=\frac{1}{k}\cdot \ln\left(\frac{A-y}{y}-B\right)
\end{equation}

Let us define a subscript notation whereby $t_{1}$ and $t_{2}$ indicate time points separated by $\Delta$ years, where $\Delta=t_{2}-t_{1}$. Likewise, $y_{1}$ and $y_{2}$ will denote sizes at those time points, respectively. Then:

\begin{equation}
\Delta =t_{2}-t_{1}=\frac{1}{k}\cdot\left[\ln\left(\frac{y_{2}}{y_{1}}\cdot\frac{A-y_{1}}{A-y_{2}}\right)\right]
\end{equation}

The $B$ coefficient has conveniently disappeared from the equation. Now we can easily deduce the following expression for $k$:

\begin{equation}
  k=\frac{1}{\Delta}\cdot\left[\ln\left(\frac{y_{2}}{y_{1}}\cdot\frac{A-y_{1}}{A-y_{2}}\right)\right]
\end{equation}

Since $t_{2}=t_{1}+\Delta$, we can arrive at an expression for $y_{2}$ as a function of $y_{1}$, $\Delta$ and the coefficients $a_{i}$:

\begin{equation}
  y_{2}=\frac{A}{1+e^{-\left(k\cdot t_{1}+B\right)}\cdot e^{-k\cdot\Delta}}=\frac{A}{1+\left(\frac{A}{y_{1}}-1\right)\cdot e^{-k\cdot\Delta}}
\end{equation}

<br>

#### Schumacher growth function

The Schumacher growth curve can be expressed as:

\begin{equation}
  y=A\cdot e^{-\frac{1}{k\cdot t+B}}
\end{equation}

For this curve to make ecological sense, $k\cdot t+B>0$ always. We have departed from the more standard Schumacher function $y=A\cdot e^{-\frac{1}{k\cdot t}}$ to allow for an extra offset parameter $B$ in the exponent. Then, we can express $t$ as:

\begin{equation}
  t=\frac{1}{k}\cdot\frac{1}{\ln\left(\frac{A}{y}\right)}-\frac{1}{k}\cdot B
\end{equation}

Now, following the same notation as shown above, we write:

\begin{equation}
  \Delta=\frac{1}{k}\cdot\left[\frac{1}{\ln\left(\frac{A}{y_{2}}\right)}-\frac{1}{\ln\left(\frac{A}{y_{1}}\right)}\right]
\end{equation}

As above, the offset $B$ has vanished from the equation. Then:

\begin{equation}
  k=\frac{1}{\Delta}\cdot\left[\frac{1}{\ln\left(\frac{A}{y_{2}}\right)}-\frac{1}{\ln\left(\frac{A}{y_{1}}\right)}\right]
\end{equation}

Therefore:

\begin{equation}
  y_{2}=A\cdot e^{-\left[\frac{1}{\frac{1}{\ln\left(\frac{A}{y_{1}}\right)}+k\cdot\Delta}\right]}
\end{equation}

This is exactly Equation [9] in Tom√© et al. (2006), Canadian Journal of Forest Research.

<br>


#### Gompertz growth function

\begin{equation}
  y=A\cdot e^{-e^{-\left(k\cdot t+B\right)}}
\end {equation}

B is an offset.

\begin{equation}
  t=\frac{1}{k}\cdot\left[\ln\left(\frac{1}{\ln\left(\frac{A}{y}\right)}\right)-B\right]
\end{equation}


\begin{equation}
  \Delta=\frac{1}{k}\cdot\ln\left(\frac{\ln\left(\frac{A}{y_{1}}\right)}{\ln\left(\frac{A}{y_{2}}\right)}\right)
\end{equation}


\begin{equation}
  k=\frac{1}{\Delta}\cdot\ln\left(\frac{\ln\left(\frac{A}{y_{1}}\right)}{\ln\left(\frac{A}{y_{2}}\right)}\right)
\end{equation}

\begin{equation}
  y_{2}=A\cdot\left(\frac{y_{1}}{A}\right)^{e^{-k\cdot\Delta}}
\end{equation}


<br>

#### Monomolecular growth function

\begin{equation}
  y=A\cdot \left(1-e^{-\left( k\cdot t+B\right)}\right)
\end {equation}


\begin{equation}
  t=\frac{1}{k}\cdot \left[\ln\left(\frac{A}{A-y}\right)-B\right]
\end {equation}

\begin{equation}
  \Delta=\frac{1}{k}\cdot \left[\ln\left(\frac{A-y_{1}}{A-y_{2}}\right)\right]
\end {equation}

\begin{equation}
  k=\frac{1}{\Delta}\cdot \left[\ln\left(\frac{A-y_{1}}{A-y_{2}}\right)\right]
\end {equation}

\begin{equation}
  y_{2}=A-\left(A-y_{1}\right)\cdot e^{-k\cdot \Delta}
\end {equation}

<br>

#### Arctangent growth function

The arctangent is another sigmoid curve from which a time-independent growth function can be derived relatively easily. We start by expressing growth as a function of time:

\begin{equation}
  y=A\cdot \left(\frac{1}{\pi}\cdot \arctan\left(k\cdot t+B\right)+0.5\right)
\end {equation}

Thus, growth $y\in \left[0,A\right]$ and $B$ has been included to allow for any possible offset in the curve. We can easily get:

\begin{equation}
  k\cdot t=\tan\left[\left(\frac{y}{A}-0.5\right)\cdot\pi\right]-B
\end{equation}

Therefore:

\begin{equation}
  t=\frac{1}{k}\cdot\tan\left[\left(\frac{y}{A}-0.5\right)\cdot\pi\right]-B
\end{equation}


\begin{equation}
  \Delta=\frac{1}{k}\cdot\left[\tan\left(\left(\frac{y_{2}}{A}-0.5\right)\cdot\pi\right)-\tan\left(\left(\frac{y_{1}}{A}-0.5\right)\cdot\pi\right)\right]
\end{equation}

Thus, the offset term $B$ has vanished from the equation. An equivalent expression for $k$ is:

\begin{equation}
  k=\frac{1}{\Delta}\cdot\left[\tan\left(\left(\frac{y_{2}}{A}-0.5\right)\cdot\pi\right)-\tan\left(\left(\frac{y_{1}}{A}-0.5\right)\cdot\pi\right)\right]
\end{equation}


Finally, we derive:

\begin{equation}
\tan\left(\left(\frac{y_{2}}{A}-0.5\right)\cdot\pi\right)=\tan\left(\left(\frac{y_{1}}{A}-0.5\right)\cdot\pi\right)+k\cdot\Delta
\end{equation}

and then:
\begin{equation}
y_{2}=A\cdot\left[\frac{1}{\pi}\cdot \arctan\left\{\tan\left(\left(\frac{y_{1}}{A}-0.5\right)\cdot\pi\right)+k\Delta\right\}+0.5\right]
\end{equation}

<br>

#### Hyperbolic tangent growth function

\begin{equation}
  y=\frac{A}{2}\cdot\left[\tanh\left(k\cdot t+B\right)+1\right]=\frac{A}{2}\cdot\frac{e^{2\cdot\left(k\cdot t+B\right)}-1}{e^{2\cdot\left(k\cdot t+B\right)}+1}=
    A\cdot\frac{e^{2\cdot k\cdot t}}{e^{2\cdot k\cdot t}+e^{-2\cdot B}}
\end{equation}


\begin{equation}
  e^{2\cdot k\cdot t}=\frac{y}{A-y}\cdot e^{-2\cdot B}
\end {equation}


\begin{equation}
  t=\frac{1}{2\cdot k}\cdot\left[\ln\left(\frac{y}{A-y}\right)-2\cdot B\right]
\end{equation}

\begin{equation}
  \Delta=\frac{1}{2\cdot k}\cdot\ln\left(\frac{y_{2}}{y_{1}}\cdot\frac{A-y_{1}}{A-y_{2}}\right)
\end{equation}

\begin{equation}
  k=\frac{1}{2\cdot\Delta}\cdot\ln\left(\frac{y_{2}}{y_{1}}\cdot\frac{A-y_{1}}{A-y_{2}}\right)
\end{equation}

Since $t_{2}=t_{1}+\Delta$:

\begin{equation}
  y_{2}=A\cdot\frac{e^{2\cdot k\cdot t_{1}}\cdot e^{2\cdot k\cdot\Delta}}{e^{2\cdot k\cdot t_{1}}\cdot e^{2\cdot k\cdot\Delta}+e^{-2\cdot B}}
\end{equation}

Thus:

\begin{equation}
  y_{2}=A\cdot\frac{\frac{y_{1}}{A-y_{1}}\cdot e^{2\cdot k\cdot\Delta}}{\frac{y_{1}}{A-y_{1}}\cdot e^{2\cdot k\cdot\Delta}+1}
\end{equation}

Finally:

\begin{equation}
  y_{2}=A\cdot\frac{y_{1}}{y_{1}+\left({A-y_{1}}\right)\cdot e^{-2\cdot k\cdot\Delta}}
\end{equation}

<br>

#### Growth rate parameter

We assume that the dependence of the growth rate parameter on a given set of predictors $X_{i}$ is linear. Then, $k$ can then be expressed as:

\begin{equation}
  k=\sum_{i=1}^{n} a_{i}\cdot X_{i}
\end{equation}

where the coefficients $a_{i}$ are unknown and must be calculated. There are cases where we wish to impose a strict positivity on $k$. At the same time, we prefer an expression that does not lead to unrealistically high values for $k$. Examples of this behaviour may come about, for example, when computing projections for $X_{i}$ values that are very different from the ones used during calibration. In those instances, we can force $k$ to be strictly positive by expressing it as a logistic function of the variables $X_{i}$. In this case, we replace the lineal expression from above with the following:

\begin{equation}
k=\frac{C}{1+e^{-\sum_{i=1}^{n} a_{i}\cdot X_{i}}}
\end{equation}

Using a logistic function for $k$ has the advantage of not letting $k$ reach absurdly low or high values, since $k\in \left[0,C\right]$ always. A new parameter $C$ is, however, necessary to set an upper limit to $k$.

